# WPlace LegitBot

An intelligent automation bot for r/place-style pixel canvas games that uses computer vision to detect and prioritize multi-colored pixels over solid blocks.

## Features

- **Smart Pixel Detection**: Uses computer vision algorithms to identify pixels with color variance (likely art or details) versus solid color blocks
- **Configurable Canvas**: Easy setup to define your canvas area using mouse positioning
- **Teleport Mode**: Instant mouse movement for maximum efficiency
- **Visual Testing**: Generate debug images showing detected pixels and grid overlay
- **Customizable Parameters**: Adjust CPS, detection sensitivity, scan intervals, and more
- **Real-time Priority Queue**: Automatically prioritizes pixels based on color variance scores

## How It Works

The bot analyzes the canvas by:
1. Capturing screenshots of the defined canvas area
2. Dividing the canvas into a grid based on pixel size (default: 41.07px for ?zoom=17)
3. Sampling colors at 5 points in each pixel region (center, top, right, bottom, left)
4. Calculating color variance using Euclidean distance in RGB space
5. Prioritizing pixels with higher variance (more detail/nuance)
6. Clicking on detected pixels in priority order

This approach helps preserve detailed artwork while targeting solid color areas that may need filling.

## Requirements
**Python Version:** Python 3.13.7, tested and working proprely on this version, if any dependencies issue appeared its 99% because of the python version.

```bash
pip install pyautogui keyboard opencv-python numpy mss time
```
or 
```bash
python installer.py
```
### Dependencies

- **pyautogui**: Mouse control and screen interaction
- **keyboard**: Keyboard monitoring and hotkeys
- **opencv-python**: Image processing (cv2)
- **numpy**: Numerical computations
- **mss**: Fast screen capture
- **time**: Time-related functions

## Installation

1. Clone or download this repository
2. Install dependencies: [Requirements](https://github.com/gitlxBD/wplace-legitbot?tab=readme-ov-file#requirements)
3. Run the script:
   ```bash
   python wplace-legitbot.py
   ```

## Usage

### Initial Setup

**⚠️ IMPORTANT: Precision is Critical**

The accuracy of pixel detection depends entirely on precise canvas positioning. Take your time during setup to ensure the bot works correctly.

**Recommended for wplace.live users:**
- **UserScript: [Hide UI + Set Box](https://github.com/gitlxBD/wplace-legitbot/blob/main/Hide%20UI%20%2B%20Set%20Box-2.0.user.js)** - Helps clearly define canvas boundaries without UI interference
- **UserScript: [OSM Blocker](https://github.com/gitlxBD/wplace-legitbot/blob/main/OSM%20Blocker-1.0.user.js)** - Prevents map overlay interference for cleaner detection

**Note:** This bot is designed to detect and target pixels generated by BlueMarble bots (solid color blocks), helping to preserve detailed artwork.

1. **Configure Canvas Area** (Option 1)
   - Move your mouse to the **top-left** corner of the canvas **precisely**
   - Press **F** to set the position
   - Move your mouse to the **bottom-right** corner of the canvas **precisely**
   - Press **F** again to complete configuration
   - The bot will calculate canvas dimensions and estimated grid size
   - **TIP:** Use maximum precision - even a few pixels off can cause misalignment

2. **Test Detection** (Option 2)
   - Runs a test scan on your configured canvas
   - Generates two images:
     - `canvas_capture.png`: Original screenshot
     - `canvas_detection.png`: Visualization with grid and detected pixels
   - Red circles indicate detected nuanced pixels (intensity = variance score)
   - Green numbers show the top 30 prioritized pixels

3. **Start Smart Bot** (Option 3)
   - Begins automated clicking in teleport mode
   - Press **Q** to stop the bot at any time
   - Bot will automatically rescan the canvas every 10 seconds (configurable)

### Configuration Options (Option 4)

- **CPS (Clicks Per Second)**: 0.1-100, default 20
- **Pixel Size**: Default 41.07px (for ?zoom=17)
  - **Custom Pixel Size**: You can manually adjust the pixel size based on your zoom level. If you zoom in or out on the canvas, the pixel size will change. Measure a single pixel on your screen and input the custom size in the configuration menu to ensure accurate detection.
- **Min Unique Colors**: Threshold for color variety (2-10)
- **Min Variance**: Minimum color variance to detect (5-50)
- **Scan Interval**: How often to rescan the canvas (seconds)

## Safety Features

- **PyAutoGUI Failsafe**: Move mouse to screen corner to emergency stop
- **Keyboard Interrupt**: Press Q during operation to stop
- **Error Handling**: Comprehensive exception catching and reporting
- **Boundary Checking**: Prevents clicks outside configured canvas area

## Configuration Details

### Default Settings

```python
canvas_top_left_x: 0
canvas_top_left_y: 0
canvas_width: 1000
canvas_height: 1000
pixel_size: 41.07
clicks_per_second: 20.0
scan_interval: 10.0
min_unique_colors: 4
min_color_variance: 20.0
```

### Detection Algorithm

The bot samples 5 points in each pixel region:
- Center point (reference color)
- Top (2/3 distance from center)
- Right (2/3 distance from center)
- Bottom (2/3 distance from center)
- Left (2/3 distance from center)

Color variance is calculated using Euclidean distance in RGB space:
```
distance = sqrt((R1-R2)² + (G1-G2)² + (B1-B2)²)
score = max_distance + average_distance
```

## Performance

- **Teleport Mode**: Instant mouse movement (0ms duration)
- **Click Speed**: Configurable up to 100 CPS (default 20 CPS for stability)
- **Scan Speed**: Depends on canvas size (typically 1-5 seconds for 1000x1000px)
- **Memory Usage**: Minimal, stores only detected pixel positions

## Tips

1. **Canvas Configuration**: ⚠️ **CRITICAL** - Be extremely precise when positioning at canvas corners. Even 1-2 pixels off can cause the entire grid to misalign. For wplace.live, use the [Hide UI + Set Box](https://github.com/gitlxBD/wplace-legitbot/blob/main/Hide%20UI%20%2B%20Set%20Box-2.0.user.js) userscript for better visibility.
2. **UserScripts for wplace.live**: Install [Hide UI + Set Box](https://github.com/gitlxBD/wplace-legitbot/blob/main/Hide%20UI%20%2B%20Set%20Box-2.0.user.js) and [OSM Blocker](https://github.com/gitlxBD/wplace-legitbot/blob/main/OSM%20Blocker-1.0.user.js) userscripts to remove UI elements and map overlays that can interfere with detection
3. **CPS Settings**: Higher CPS uses more CPU; 20 CPS is a good balance for stability and performance
4. **Zoom Level Adjustment**: If you zoom in or out on the canvas, you'll need to manually recalculate the pixel size. Use a ruler tool or measure a single pixel on your screen, then update the custom pixel size in the configuration menu (Option 4)
5. **Detection Sensitivity**: Lower `min_color_variance` detects more pixels; higher values target only high-contrast areas
6. **Testing First**: Always use "Test detection" to verify proper canvas configuration before running the bot
7. **BlueMarble Detection**: This bot specifically targets solid color blocks typically generated by BlueMarble, helping to preserve detailed community artwork

## Troubleshooting

### Bot clicks in wrong locations
- Reconfigure canvas area (Option 1)
- Ensure canvas hasn't moved on screen

### No pixels detected
- Lower `min_color_variance` value
- Lower `min_unique_colors` value
- Verify canvas is visible and not obscured

### Performance issues
- Reduce CPS setting
- Increase scan interval
- Close other applications

## Disclaimer

This bot is for educational purposes. Use responsibly and in accordance with the terms of service of any platform you're interacting with. Automated tools may be against the rules of some games or services.

## Credits

Created by gitlxBD  
Contact: rabaisseur on Discord

## License

This project is provided as-is for educational purposes.
